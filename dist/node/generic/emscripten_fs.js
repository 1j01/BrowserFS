var BrowserFS = require('../core/browserfs');
var fs = require('../core/node_fs');
var util_1 = require('../core/util');
var BFSEmscriptenStreamOps = (function () {
    function BFSEmscriptenStreamOps(fs) {
        this.fs = fs;
        this.FS = fs.getFS();
        this.PATH = fs.getPATH();
        this.ERRNO_CODES = fs.getERRNO_CODES();
    }
    BFSEmscriptenStreamOps.prototype.open = function (stream) {
        var path = this.fs.realPath(stream.node), FS = this.FS;
        try {
            if (FS.isFile(stream.node.mode)) {
                stream.nfd = fs.openSync(path, this.fs.flagsToPermissionString(stream.flags));
            }
        }
        catch (e) {
            if (!e.code)
                throw e;
            throw new FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
    };
    BFSEmscriptenStreamOps.prototype.close = function (stream) {
        var FS = this.FS;
        try {
            if (FS.isFile(stream.node.mode) && stream.nfd) {
                fs.closeSync(stream.nfd);
            }
        }
        catch (e) {
            if (!e.code)
                throw e;
            throw new FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
    };
    BFSEmscriptenStreamOps.prototype.read = function (stream, buffer, offset, length, position) {
        try {
            return fs.readSync(stream.nfd, util_1.uint8Array2Buffer(buffer), offset, length, position);
        }
        catch (e) {
            throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
    };
    BFSEmscriptenStreamOps.prototype.write = function (stream, buffer, offset, length, position) {
        try {
            return fs.writeSync(stream.nfd, util_1.uint8Array2Buffer(buffer), offset, length, position);
        }
        catch (e) {
            throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
    };
    BFSEmscriptenStreamOps.prototype.llseek = function (stream, offset, whence) {
        var position = offset;
        if (whence === 1) {
            position += stream.position;
        }
        else if (whence === 2) {
            if (this.FS.isFile(stream.node.mode)) {
                try {
                    var stat = fs.fstatSync(stream.nfd);
                    position += stat.size;
                }
                catch (e) {
                    throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
                }
            }
        }
        if (position < 0) {
            throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);
        }
        stream.position = position;
        return position;
    };
    return BFSEmscriptenStreamOps;
})();
var BFSEmscriptenNodeOps = (function () {
    function BFSEmscriptenNodeOps(fs) {
        this.fs = fs;
        this.FS = fs.getFS();
        this.PATH = fs.getPATH();
        this.ERRNO_CODES = fs.getERRNO_CODES();
    }
    BFSEmscriptenNodeOps.prototype.getattr = function (node) {
        var path = this.fs.realPath(node);
        var stat;
        try {
            stat = fs.lstatSync(path);
        }
        catch (e) {
            if (!e.code)
                throw e;
            throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
        return {
            dev: stat.dev,
            ino: stat.ino,
            mode: stat.mode,
            nlink: stat.nlink,
            uid: stat.uid,
            gid: stat.gid,
            rdev: stat.rdev,
            size: stat.size,
            atime: stat.atime,
            mtime: stat.mtime,
            ctime: stat.ctime,
            blksize: stat.blksize,
            blocks: stat.blocks
        };
    };
    BFSEmscriptenNodeOps.prototype.setattr = function (node, attr) {
        var path = this.fs.realPath(node);
        try {
            if (attr.mode !== undefined) {
                fs.chmodSync(path, attr.mode);
                node.mode = attr.mode;
            }
            if (attr.timestamp !== undefined) {
                var date = new Date(attr.timestamp);
                fs.utimesSync(path, date, date);
            }
        }
        catch (e) {
            if (!e.code)
                throw e;
            if (e.code !== "ENOTSUP") {
                throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
            }
        }
        if (attr.size !== undefined) {
            try {
                fs.truncateSync(path, attr.size);
            }
            catch (e) {
                if (!e.code)
                    throw e;
                throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
            }
        }
    };
    BFSEmscriptenNodeOps.prototype.lookup = function (parent, name) {
        var path = this.PATH.join2(this.fs.realPath(parent), name);
        var mode = this.fs.getMode(path);
        return this.fs.createNode(parent, name, mode);
    };
    BFSEmscriptenNodeOps.prototype.mknod = function (parent, name, mode, dev) {
        var node = this.fs.createNode(parent, name, mode, dev);
        var path = this.fs.realPath(node);
        try {
            if (this.FS.isDir(node.mode)) {
                fs.mkdirSync(path, node.mode);
            }
            else {
                fs.writeFileSync(path, '', { mode: node.mode });
            }
        }
        catch (e) {
            if (!e.code)
                throw e;
            throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
        return node;
    };
    BFSEmscriptenNodeOps.prototype.rename = function (oldNode, newDir, newName) {
        var oldPath = this.fs.realPath(oldNode);
        var newPath = this.PATH.join2(this.fs.realPath(newDir), newName);
        try {
            fs.renameSync(oldPath, newPath);
        }
        catch (e) {
            if (!e.code)
                throw e;
            throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
    };
    BFSEmscriptenNodeOps.prototype.unlink = function (parent, name) {
        var path = this.PATH.join2(this.fs.realPath(parent), name);
        try {
            fs.unlinkSync(path);
        }
        catch (e) {
            if (!e.code)
                throw e;
            throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
    };
    BFSEmscriptenNodeOps.prototype.rmdir = function (parent, name) {
        var path = this.PATH.join2(this.fs.realPath(parent), name);
        try {
            fs.rmdirSync(path);
        }
        catch (e) {
            if (!e.code)
                throw e;
            throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
    };
    BFSEmscriptenNodeOps.prototype.readdir = function (node) {
        var path = this.fs.realPath(node);
        try {
            return fs.readdirSync(path);
        }
        catch (e) {
            if (!e.code)
                throw e;
            throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
    };
    BFSEmscriptenNodeOps.prototype.symlink = function (parent, newName, oldPath) {
        var newPath = this.PATH.join2(this.fs.realPath(parent), newName);
        try {
            fs.symlinkSync(oldPath, newPath);
        }
        catch (e) {
            if (!e.code)
                throw e;
            throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
    };
    BFSEmscriptenNodeOps.prototype.readlink = function (node) {
        var path = this.fs.realPath(node);
        try {
            return fs.readlinkSync(path);
        }
        catch (e) {
            if (!e.code)
                throw e;
            throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
    };
    return BFSEmscriptenNodeOps;
})();
var BFSEmscriptenFS = (function () {
    function BFSEmscriptenFS(_FS, _PATH, _ERRNO_CODES) {
        if (_FS === void 0) { _FS = self['FS']; }
        if (_PATH === void 0) { _PATH = self['PATH']; }
        if (_ERRNO_CODES === void 0) { _ERRNO_CODES = self['ERRNO_CODES']; }
        this.flagsToPermissionStringMap = {
            0: 'r',
            1: 'r+',
            2: 'r+',
            64: 'r',
            65: 'r+',
            66: 'r+',
            129: 'rx+',
            193: 'rx+',
            514: 'w+',
            577: 'w',
            578: 'w+',
            705: 'wx',
            706: 'wx+',
            1024: 'a',
            1025: 'a',
            1026: 'a+',
            1089: 'a',
            1090: 'a+',
            1153: 'ax',
            1154: 'ax+',
            1217: 'ax',
            1218: 'ax+',
            4096: 'rs',
            4098: 'rs+'
        };
        if (typeof BrowserFS === 'undefined') {
            throw new Error("BrowserFS is not loaded. Please load it before this library.");
        }
        this.FS = _FS;
        this.PATH = _PATH;
        this.ERRNO_CODES = _ERRNO_CODES;
        this.node_ops = new BFSEmscriptenNodeOps(this);
        this.stream_ops = new BFSEmscriptenStreamOps(this);
    }
    BFSEmscriptenFS.prototype.mount = function (mount) {
        return this.createNode(null, '/', this.getMode(mount.opts.root), 0);
    };
    BFSEmscriptenFS.prototype.createNode = function (parent, name, mode, dev) {
        var FS = this.FS;
        if (!FS.isDir(mode) && !FS.isFile(mode) && !FS.isLink(mode)) {
            throw new FS.ErrnoError(this.ERRNO_CODES.EINVAL);
        }
        var node = FS.createNode(parent, name, mode);
        node.node_ops = this.node_ops;
        node.stream_ops = this.stream_ops;
        return node;
    };
    BFSEmscriptenFS.prototype.getMode = function (path) {
        var stat;
        try {
            stat = fs.lstatSync(path);
        }
        catch (e) {
            if (!e.code)
                throw e;
            throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code]);
        }
        return stat.mode;
    };
    BFSEmscriptenFS.prototype.realPath = function (node) {
        var parts = [];
        while (node.parent !== node) {
            parts.push(node.name);
            node = node.parent;
        }
        parts.push(node.mount.opts.root);
        parts.reverse();
        return this.PATH.join.apply(null, parts);
    };
    BFSEmscriptenFS.prototype.flagsToPermissionString = function (flags) {
        var parsedFlags = (typeof flags === "string") ? parseInt(flags, 10) : flags;
        parsedFlags &= 0x1FFF;
        if (parsedFlags in this.flagsToPermissionStringMap) {
            return this.flagsToPermissionStringMap[parsedFlags];
        }
        else {
            return flags;
        }
    };
    BFSEmscriptenFS.prototype.getFS = function () {
        return this.FS;
    };
    BFSEmscriptenFS.prototype.getPATH = function () {
        return this.PATH;
    };
    BFSEmscriptenFS.prototype.getERRNO_CODES = function () {
        return this.ERRNO_CODES;
    };
    return BFSEmscriptenFS;
})();
exports.__esModule = true;
exports["default"] = BFSEmscriptenFS;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW1zY3JpcHRlbl9mcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9nZW5lcmljL2Vtc2NyaXB0ZW5fZnMudHMiXSwibmFtZXMiOlsiQkZTRW1zY3JpcHRlblN0cmVhbU9wcyIsIkJGU0Vtc2NyaXB0ZW5TdHJlYW1PcHMuY29uc3RydWN0b3IiLCJCRlNFbXNjcmlwdGVuU3RyZWFtT3BzLm9wZW4iLCJCRlNFbXNjcmlwdGVuU3RyZWFtT3BzLmNsb3NlIiwiQkZTRW1zY3JpcHRlblN0cmVhbU9wcy5yZWFkIiwiQkZTRW1zY3JpcHRlblN0cmVhbU9wcy53cml0ZSIsIkJGU0Vtc2NyaXB0ZW5TdHJlYW1PcHMubGxzZWVrIiwiQkZTRW1zY3JpcHRlbk5vZGVPcHMiLCJCRlNFbXNjcmlwdGVuTm9kZU9wcy5jb25zdHJ1Y3RvciIsIkJGU0Vtc2NyaXB0ZW5Ob2RlT3BzLmdldGF0dHIiLCJCRlNFbXNjcmlwdGVuTm9kZU9wcy5zZXRhdHRyIiwiQkZTRW1zY3JpcHRlbk5vZGVPcHMubG9va3VwIiwiQkZTRW1zY3JpcHRlbk5vZGVPcHMubWtub2QiLCJCRlNFbXNjcmlwdGVuTm9kZU9wcy5yZW5hbWUiLCJCRlNFbXNjcmlwdGVuTm9kZU9wcy51bmxpbmsiLCJCRlNFbXNjcmlwdGVuTm9kZU9wcy5ybWRpciIsIkJGU0Vtc2NyaXB0ZW5Ob2RlT3BzLnJlYWRkaXIiLCJCRlNFbXNjcmlwdGVuTm9kZU9wcy5zeW1saW5rIiwiQkZTRW1zY3JpcHRlbk5vZGVPcHMucmVhZGxpbmsiLCJCRlNFbXNjcmlwdGVuRlMiLCJCRlNFbXNjcmlwdGVuRlMuY29uc3RydWN0b3IiLCJCRlNFbXNjcmlwdGVuRlMubW91bnQiLCJCRlNFbXNjcmlwdGVuRlMuY3JlYXRlTm9kZSIsIkJGU0Vtc2NyaXB0ZW5GUy5nZXRNb2RlIiwiQkZTRW1zY3JpcHRlbkZTLnJlYWxQYXRoIiwiQkZTRW1zY3JpcHRlbkZTLmZsYWdzVG9QZXJtaXNzaW9uU3RyaW5nIiwiQkZTRW1zY3JpcHRlbkZTLmdldEZTIiwiQkZTRW1zY3JpcHRlbkZTLmdldFBBVEgiLCJCRlNFbXNjcmlwdGVuRlMuZ2V0RVJSTk9fQ09ERVMiXSwibWFwcGluZ3MiOiJBQVdBLElBQU8sU0FBUyxXQUFXLG1CQUFtQixDQUFDLENBQUM7QUFDaEQsSUFBTyxFQUFFLFdBQVcsaUJBQWlCLENBQUMsQ0FBQztBQUV2QyxxQkFBZ0MsY0FBYyxDQUFDLENBQUE7QUFpRS9DO0lBS0VBLGdDQUFvQkEsRUFBbUJBO1FBQW5CQyxPQUFFQSxHQUFGQSxFQUFFQSxDQUFpQkE7UUFDckNBLElBQUlBLENBQUNBLEVBQUVBLEdBQUdBLEVBQUVBLENBQUNBLEtBQUtBLEVBQUVBLENBQUNBO1FBQ3JCQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxFQUFFQSxDQUFDQSxPQUFPQSxFQUFFQSxDQUFDQTtRQUN6QkEsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsRUFBRUEsQ0FBQ0EsY0FBY0EsRUFBRUEsQ0FBQ0E7SUFDekNBLENBQUNBO0lBRU1ELHFDQUFJQSxHQUFYQSxVQUFZQSxNQUF3QkE7UUFDbENFLElBQUlBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFFBQVFBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLEVBQ3RDQSxFQUFFQSxHQUFHQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQTtRQUNmQSxJQUFJQSxDQUFDQTtZQUNIQSxFQUFFQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxNQUFNQSxDQUFDQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDaENBLE1BQU1BLENBQUNBLEdBQUdBLEdBQUdBLEVBQUVBLENBQUNBLFFBQVFBLENBQUNBLElBQUlBLEVBQUVBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLHVCQUF1QkEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDaEZBLENBQUNBO1FBQ0hBLENBQUVBO1FBQUFBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ1hBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBO2dCQUFDQSxNQUFNQSxDQUFDQSxDQUFDQTtZQUNyQkEsTUFBTUEsSUFBSUEsRUFBRUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDcERBLENBQUNBO0lBQ0hBLENBQUNBO0lBRU1GLHNDQUFLQSxHQUFaQSxVQUFhQSxNQUF3QkE7UUFDbkNHLElBQUlBLEVBQUVBLEdBQUdBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBO1FBQ2pCQSxJQUFJQSxDQUFDQTtZQUNIQSxFQUFFQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxNQUFNQSxDQUFDQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxNQUFNQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDOUNBLEVBQUVBLENBQUNBLFNBQVNBLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1lBQzNCQSxDQUFDQTtRQUNIQSxDQUFFQTtRQUFBQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNYQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQTtnQkFBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7WUFDckJBLE1BQU1BLElBQUlBLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1FBQ3BEQSxDQUFDQTtJQUNIQSxDQUFDQTtJQUVNSCxxQ0FBSUEsR0FBWEEsVUFBWUEsTUFBd0JBLEVBQUVBLE1BQWtCQSxFQUFFQSxNQUFjQSxFQUFFQSxNQUFjQSxFQUFFQSxRQUFnQkE7UUFFeEdJLElBQUlBLENBQUNBO1lBQ0hBLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBLFFBQVFBLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLEVBQUVBLHdCQUFpQkEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsRUFBRUEsTUFBTUEsRUFBRUEsTUFBTUEsRUFBRUEsUUFBUUEsQ0FBQ0EsQ0FBQ0E7UUFDdEZBLENBQUVBO1FBQUFBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ1hBLE1BQU1BLElBQUlBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1FBQ3pEQSxDQUFDQTtJQUNIQSxDQUFDQTtJQUVNSixzQ0FBS0EsR0FBWkEsVUFBYUEsTUFBd0JBLEVBQUVBLE1BQWtCQSxFQUFFQSxNQUFjQSxFQUFFQSxNQUFjQSxFQUFFQSxRQUFnQkE7UUFFekdLLElBQUlBLENBQUNBO1lBQ0hBLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBLFNBQVNBLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLEVBQUVBLHdCQUFpQkEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsRUFBRUEsTUFBTUEsRUFBRUEsTUFBTUEsRUFBRUEsUUFBUUEsQ0FBQ0EsQ0FBQ0E7UUFDdkZBLENBQUVBO1FBQUFBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ1hBLE1BQU1BLElBQUlBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1FBQ3pEQSxDQUFDQTtJQUNIQSxDQUFDQTtJQUVNTCx1Q0FBTUEsR0FBYkEsVUFBY0EsTUFBd0JBLEVBQUVBLE1BQWNBLEVBQUVBLE1BQWNBO1FBQ3BFTSxJQUFJQSxRQUFRQSxHQUFHQSxNQUFNQSxDQUFDQTtRQUN0QkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsTUFBTUEsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDakJBLFFBQVFBLElBQUlBLE1BQU1BLENBQUNBLFFBQVFBLENBQUNBO1FBQzlCQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxNQUFNQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN4QkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3JDQSxJQUFJQSxDQUFDQTtvQkFDSEEsSUFBSUEsSUFBSUEsR0FBR0EsRUFBRUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7b0JBQ3BDQSxRQUFRQSxJQUFJQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQTtnQkFDeEJBLENBQUVBO2dCQUFBQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDWEEsTUFBTUEsSUFBSUEsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3pEQSxDQUFDQTtZQUNIQSxDQUFDQTtRQUNIQSxDQUFDQTtRQUVEQSxFQUFFQSxDQUFDQSxDQUFDQSxRQUFRQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNqQkEsTUFBTUEsSUFBSUEsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7UUFDeERBLENBQUNBO1FBRURBLE1BQU1BLENBQUNBLFFBQVFBLEdBQUdBLFFBQVFBLENBQUNBO1FBQzNCQSxNQUFNQSxDQUFDQSxRQUFRQSxDQUFDQTtJQUNs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Q0E7Z0JBQ3BDQSxFQUFFQSxDQUFDQSxVQUFVQSxDQUFDQSxJQUFJQSxFQUFFQSxJQUFJQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUNsQ0EsQ0FBQ0E7UUFDSEEsQ0FBRUE7UUFBQUEsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDWEEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0E7Z0JBQUNBLE1BQU1BLENBQUNBLENBQUNBO1lBR3JCQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxLQUFLQSxTQUFTQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDekJBLE1BQU1BLElBQUlBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1lBQ3pEQSxDQUFDQTtRQUNIQSxDQUFDQTtRQUNEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxLQUFLQSxTQUFTQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUM1QkEsSUFBSUEsQ0FBQ0E7Z0JBQ0hBLEVBQUVBLENBQUNBLFlBQVlBLENBQUNBLElBQUlBLEVBQUVBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ25DQSxDQUFFQTtZQUFBQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDWEEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0E7b0JBQUNBLE1BQU1BLENBQUNBLENBQUNBO2dCQUNyQkEsTUFBTUEsSUFBSUEsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDekRBLENBQUNBO1FBQ0hBLENBQUNBO0lBQ0hBLENBQUNBO0lBRU1ILHFDQUFNQSxHQUFiQSxVQUFjQSxNQUF3QkEsRUFBRUEsSUFBWUE7UUFDbERJLElBQUlBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFFBQVFBLENBQUNBLE1BQU1BLENBQUNBLEVBQUVBLElBQUlBLENBQUNBLENBQUNBO1FBQzNEQSxJQUFJQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxPQUFPQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtRQUNqQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsTUFBTUEsRUFBRUEsSUFBSUEsRUFBRUEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7SUFDaERBLENBQUNBO0lBRU1KLG9DQUFLQSxHQUFaQSxVQUFhQSxNQUF3QkEsRUFBRUEsSUFBWUEsRUFBRUEsSUFBWUEsRUFBRUEsR0FBUUE7UUFDekVLLElBQUlBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLE1BQU1BLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLEdBQUdBLENBQUNBLENBQUNBO1FBRXZEQSxJQUFJQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtRQUNsQ0EsSUFBSUEsQ0FBQ0E7WUFDSEEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQzdCQSxFQUFFQSxDQUFDQSxTQUFTQSxDQUFDQSxJQUFJQSxFQUFFQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUNoQ0EsQ0FBQ0E7WUFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7Z0JBQ05BLEVBQUVBLENBQUNBLGFBQWFBLENBQUNBLElBQUlBLEVBQUVBLEVBQUVBLEVBQUVBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLENBQUNBLElBQUlBLEVBQUVBLENBQUNBLENBQUNBO1lBQ2xEQSxDQUFDQTtRQUNIQSxDQUFFQTtRQUFBQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNYQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQTtnQkFBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7WUFDckJBLE1BQU1BLElBQUlBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1FBQ3pEQSxDQUFDQTtRQUNEQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQTtJQUNkQSxDQUFDQTtJQUVNTCxxQ0FBTUEsR0FBYkEsVUFBY0EsT0FBeUJBLEVBQUVBLE1BQXdCQSxFQUFFQSxPQUFlQTtRQUNoRk0sSUFBSUEsT0FBT0EsR0FBR0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQ0E7UUFDeENBLElBQUlBLE9BQU9BLEdBQUdBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFFBQVFBLENBQUNBLE1BQU1BLENBQUNBLEVBQUVBLE9BQU9BLENBQUNBLENBQUNBO1FBQ2pFQSxJQUFJQSxDQUFDQTtZQUNIQSxFQUFFQSxDQUFDQSxVQUFVQSxDQUFDQSxPQUFPQSxFQUFFQSxPQUFPQSxDQUFDQSxDQUFDQTtRQUNsQ0EsQ0FBRUE7UUFBQUEsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDWEEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0E7Z0JBQUNBLE1BQU1BLENBQUNBLENBQUNBO1lBQ3JCQSxNQUFNQSxJQUFJQSxJ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TVIsd0NBQWNBLEdBQXJCQTtRQUNFUyxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQTtJQUMxQkEsQ0FBQ0E7SUFJSFQsc0JBQUNBO0FBQURBLENBQUNBLEFBeEdELElBd0dDO0FBeEdEO29DQXdHQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEZWZpbmVzIGFuIEVtc2NyaXB0ZW4gZmlsZSBzeXN0ZW0gb2JqZWN0IGZvciB1c2UgaW4gdGhlIEVtc2NyaXB0ZW4gdmlydHVhbFxuICogZmlsZXN5c3RlbS4gQWxsb3dzIHlvdSB0byB1c2Ugc3luY2hyb25vdXMgQnJvd3NlckZTIGZpbGUgc3lzdGVtcyBmcm9tIHdpdGhpblxuICogRW1zY3JpcHRlbi5cbiAqXG4gKiBZb3UgY2FuIGNvbnN0cnVjdCBhIEJGU0Vtc2NyaXB0ZW5GUywgbW91bnQgaXQgdXNpbmcgaXRzIG1vdW50IGNvbW1hbmQsXG4gKiBhbmQgdGhlbiBtb3VudCBpdCBpbnRvIEVtc2NyaXB0ZW4uXG4gKlxuICogQWRhcHRlZCBmcm9tIEVtc2NyaXB0ZW4ncyBOb2RlRlM6XG4gKiBodHRwczovL3Jhdy5naXRodWIuY29tL2tyaXBrZW4vZW1zY3JpcHRlbi9tYXN0ZXIvc3JjL2xpYnJhcnlfbm9kZWZzLmpzXG4gKi9cbmltcG9ydCBCcm93c2VyRlMgPSByZXF1aXJlKCcuLi9jb3JlL2Jyb3dzZXJmcycpO1xuaW1wb3J0IGZzID0gcmVxdWlyZSgnLi4vY29yZS9ub2RlX2ZzJyk7XG5pbXBvcnQgbm9kZV9mc19zdGF0cyA9IHJlcXVpcmUoJy4uL2NvcmUvbm9kZV9mc19zdGF0cycpO1xuaW1wb3J0IHt1aW50OEFycmF5MkJ1ZmZlcn0gZnJvbSAnLi4vY29yZS91dGlsJztcblxuZXhwb3J0IGludGVyZmFjZSBTdGF0cyB7XG4gIGRldjogbnVtYmVyO1xuICBpbm86IG51bWJlcjtcbiAgbW9kZTogbnVtYmVyO1xuICBubGluazogbnVtYmVyO1xuICB1aWQ6IG51bWJlcjtcbiAgZ2lkOiBudW1iZXI7XG4gIHJkZXY6IG51bWJlcjtcbiAgc2l6ZTogbnVtYmVyO1xuICBibGtzaXplOiBudW1iZXI7XG4gIGJsb2NrczogbnVtYmVyO1xuICBhdGltZTogRGF0ZTtcbiAgbXRpbWU6IERhdGU7XG4gIGN0aW1lOiBEYXRlO1xuICB0aW1lc3RhbXA/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1zY3JpcHRlbkZTTm9kZSB7XG4gIG5hbWU6IHN0cmluZztcbiAgbW9kZTogbnVtYmVyO1xuICBwYXJlbnQ6IEVtc2NyaXB0ZW5GU05vZGU7XG4gIG1vdW50OiB7b3B0czoge3Jvb3Q6IHN0cmluZ319O1xuICBzdHJlYW1fb3BzOiBFbXNjcmlwdGVuU3RyZWFtT3BzO1xuICBub2RlX29wczogRW1zY3JpcHRlbk5vZGVPcHM7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1zY3JpcHRlblN0cmVhbSB7XG4gIG5vZGU6IEVtc2NyaXB0ZW5GU05vZGU7XG4gIG5mZDogYW55O1xuICBmbGFnczogc3RyaW5nO1xuICBwb3NpdGlvbjogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVtc2NyaXB0ZW5Ob2RlT3BzIHtcbiAgZ2V0YXR0cihub2RlOiBFbXNjcmlwdGVuRlNOb2RlKTogU3RhdHM7XG4gIHNldGF0dHIobm9kZTogRW1zY3JpcHRlbkZTTm9kZSwgYXR0cjogU3RhdHMpOiB2b2lkO1xuICBsb29rdXAocGFyZW50OiBFbXNjcmlwdGVuRlNOb2RlLCBuYW1lOiBzdHJpbmcpOiBFbXNjcmlwdGVuRlNOb2RlO1xuICBta25vZChwYXJlbnQ6IEVtc2NyaXB0ZW5GU05vZGUsIG5hbWU6IHN0cmluZywgbW9kZTogbnVtYmVyLCBkZXY6IGFueSk6IEVtc2NyaXB0ZW5GU05vZGU7XG4gIHJlbmFtZShvbGROb2RlOiBFbXNjcmlwdGVuRlNOb2RlLCBuZXdEaXI6IEVtc2NyaXB0ZW5GU05vZGUsIG5ld05hbWU6IHN0cmluZyk6IHZvaWQ7XG4gIHVubGluayhwYXJlbnQ6IEVtc2NyaXB0ZW5GU05vZGUsIG5hbWU6IHN0cmluZyk6IHZvaWQ7XG4gIHJtZGlyKHBhcmVudDogRW1zY3JpcHRlbkZTTm9kZSwgbmFtZTogc3RyaW5nKTogdm9pZDtcbiAgcmVhZGRpcihub2RlOiBFbXNjcmlwdGVuRlNOb2RlKTogc3RyaW5nW107XG4gIHN5bWxpbmsocGFyZW50OiBFbXNjcmlwdGVuRlNOb2RlLCBuZXdOYW1lOiBzdHJpbmcsIG9sZFBhdGg6IHN0cmluZyk6IHZvaWQ7XG4gIHJlYWRsaW5rKG5vZGU6IEVtc2NyaXB0ZW5GU05vZGUpOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1zY3JpcHRlblN0cmVhbU9wcyB7XG4gIG9wZW4oc3RyZWFtOiBFbXNjcmlwdGVuU3RyZWFtKTogdm9pZDtcbiAgY2xvc2Uoc3RyZWFtOiBFbXNjcmlwdGVuU3RyZWFtKTogdm9pZDtcbiAgcmVhZChzdHJlYW06IEVtc2NyaXB0ZW5TdHJlYW0sIGJ1ZmZlcjogVWludDhBcnJheSwgb2Zmc2V0OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyLCBwb3NpdGlvbjogbnVtYmVyKTogbnVtYmVyO1xuICB3cml0ZShzdHJlYW06IEVtc2NyaXB0ZW5TdHJlYW0sIGJ1ZmZlcjogVWludDhBcnJheSwgb2Zmc2V0OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyLCBwb3NpdGlvbjogbnVtYmVyKTogbnVtYmVyO1xuICBsbHNlZWsoc3RyZWFtOiBFbXNjcmlwdGVuU3RyZWFtLCBvZmZzZXQ6IG51bWJlciwgd2hlbmNlOiBudW1iZXIpOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1zY3JpcHRlbkZTIHtcbiAgbW91bnQobW91bnQ6IHtvcHRzOiB7cm9vdDogc3RyaW5nfX0pOiBFbXNjcmlwdGVuRlNOb2RlO1xuICBjcmVhdGVOb2RlKHBhcmVudDogRW1zY3JpcHRlbkZTTm9kZSwgbmFtZTogc3RyaW5nLCBtb2RlOiBudW1iZXIsIGRldj86IGFueSk6IEVtc2NyaXB0ZW5GU05vZGU7XG4gIGdldE1vZGUocGF0aDogc3RyaW5nKTogbnVtYmVyO1xuICByZWFsUGF0aChub2RlOiBFbXNjcmlwdGVuRlNOb2RlKTogc3RyaW5nO1xuICBub2RlX29wczogRW1zY3JpcHRlbk5vZGVPcHM7XG4gIHN0cmVhbV9vcHM6IEVtc2NyaXB0ZW5TdHJlYW1PcHM7XG59XG5cbmNsYXNzIEJGU0Vtc2NyaXB0ZW5TdHJlYW1PcHMgaW1wbGVtZW50cyBFbXNjcmlwdGVuU3RyZWFtT3BzIHtcbiAgcHJpdmF0ZSBGUzogYW55O1xuICBwcml2YXRlIFBBVEg6IGFueTtcbiAgcHJpdmF0ZSBFUlJOT19DT0RFUzogYW55O1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZnM6IEJGU0Vtc2NyaXB0ZW5GUykge1xuICAgIHRoaXMuRlMgPSBmcy5nZXRGUygpO1xuICAgIHRoaXMuUEFUSCA9IGZzLmdldFBBVEgoKTtcbiAgICB0aGlzLkVSUk5PX0NPREVTID0gZnMuZ2V0RVJSTk9fQ09ERVMoKTtcbiAgfVxuXG4gIHB1YmxpYyBvcGVuKHN0cmVhbTogRW1zY3JpcHRlblN0cmVhbSk6IHZvaWQge1xuICAgIHZhciBwYXRoID0gdGhpcy5mcy5yZWFsUGF0aChzdHJlYW0ubm9kZSksXG4gICAgICBGUyA9IHRoaXMuRlM7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChGUy5pc0ZpbGUoc3RyZWFtLm5vZGUubW9kZSkpIHtcbiAgICAgICAgc3RyZWFtLm5mZCA9IGZzLm9wZW5TeW5jKHBhdGgsIHRoaXMuZnMuZmxhZ3NUb1Blcm1pc3Npb25TdHJpbmcoc3RyZWFtLmZsYWdzKSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKCFlLmNvZGUpIHRocm93IGU7XG4gICAgICB0aHJvdyBuZXcgRlMuRXJybm9FcnJvcih0aGlzLkVSUk5PX0NPREVTW2UuY29kZV0pO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBjbG9zZShzdHJlYW06IEVtc2NyaXB0ZW5TdHJlYW0pOiB2b2lkIHtcbiAgICB2YXIgRlMgPSB0aGlzLkZTO1xuICAgIHRyeSB7XG4gICAgICBpZiAoRlMuaXNGaWxlKHN0cmVhbS5ub2RlLm1vZGUpICYmIHN0cmVhbS5uZmQpIHtcbiAgICAgICAgZnMuY2xvc2VTeW5jKHN0cmVhbS5uZmQpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmICghZS5jb2RlKSB0aHJvdyBlO1xuICAgICAgdGhyb3cgbmV3IEZTLkVycm5vRXJyb3IodGhpcy5FUlJOT19DT0RFU1tlLmNvZGVdKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgcmVhZChzdHJlYW06IEVtc2NyaXB0ZW5TdHJlYW0sIGJ1ZmZlcjogVWludDhBcnJheSwgb2Zmc2V0OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyLCBwb3NpdGlvbjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAvLyBBdm9pZCBjb3B5aW5nIG92ZXJoZWFkIGJ5IHJlYWRpbmcgZGlyZWN0bHkgaW50byBidWZmZXIuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBmcy5yZWFkU3luYyhzdHJlYW0ubmZkLCB1aW50OEFycmF5MkJ1ZmZlcihidWZmZXIpLCBvZmZzZXQsIGxlbmd0aCwgcG9zaXRpb24pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyB0aGlzLkZTLkVycm5vRXJyb3IodGhpcy5FUlJOT19DT0RFU1tlLmNvZGVdKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgd3JpdGUoc3RyZWFtOiBFbXNjcmlwdGVuU3RyZWFtLCBidWZmZXI6IFVpbnQ4QXJyYXksIG9mZnNldDogbnVtYmVyLCBsZW5ndGg6IG51bWJlciwgcG9zaXRpb246IG51bWJlcik6IG51bWJlciB7XG4gICAgLy8gQXZvaWQgY29weWluZyBvdmVyaGVhZC5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGZzLndyaXRlU3luYyhzdHJlYW0ubmZkLCB1aW50OEFycmF5MkJ1ZmZlcihidWZmZXIpLCBvZmZzZXQsIGxlbmd0aCwgcG9zaXRpb24pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyB0aGlzLkZTLkVycm5vRXJyb3IodGhpcy5FUlJOT19DT0RFU1tlLmNvZGVdKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgbGxzZWVrKHN0cmVhbTogRW1zY3JpcHRlblN0cmVhbSwgb2Zmc2V0OiBudW1iZXIsIHdoZW5jZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICB2YXIgcG9zaXRpb24gPSBvZmZzZXQ7XG4gICAgaWYgKHdoZW5jZSA9PT0gMSkgeyAgLy8gU0VFS19DVVIuXG4gICAgICBwb3NpdGlvbiArPSBzdHJlYW0ucG9zaXRpb247XG4gICAgfSBlbHNlIGlmICh3aGVuY2UgPT09IDIpIHsgIC8vIFNFRUtfRU5ELlxuICAgICAgaWYgKHRoaXMuRlMuaXNGaWxlKHN0cmVhbS5ub2RlLm1vZGUpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdmFyIHN0YXQgPSBmcy5mc3RhdFN5bmMoc3RyZWFtLm5mZCk7XG4gICAgICAgICAgcG9zaXRpb24gKz0gc3RhdC5zaXplO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IHRoaXMuRlMuRXJybm9FcnJvcih0aGlzLkVSUk5PX0NPREVTW2UuY29kZV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHBvc2l0aW9uIDwgMCkge1xuICAgICAgdGhyb3cgbmV3IHRoaXMuRlMuRXJybm9FcnJvcih0aGlzLkVSUk5PX0NPREVTLkVJTlZBTCk7XG4gICAgfVxuXG4gICAgc3RyZWFtLnBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgcmV0dXJuIHBvc2l0aW9uO1xuICB9XG59XG5cbmNsYXNzIEJGU0Vtc2NyaXB0ZW5Ob2RlT3BzIGltcGxlbWVudHMgRW1zY3JpcHRlbk5vZGVPcHMge1xuICBwcml2YXRlIEZTOiBhbnk7XG4gIHByaXZhdGUgUEFUSDogYW55O1xuICBwcml2YXRlIEVSUk5PX0NPREVTOiBhbnk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBmczogQkZTRW1zY3JpcHRlbkZTKSB7XG4gICAgdGhpcy5GUyA9IGZzLmdldEZTKCk7XG4gICAgdGhpcy5QQVRIID0gZnMuZ2V0UEFUSCgpO1xuICAgIHRoaXMuRVJSTk9fQ09ERVMgPSBmcy5nZXRFUlJOT19DT0RFUygpO1xuICB9XG5cbiAgcHVibGljIGdldGF0dHIobm9kZTogRW1zY3JpcHRlbkZTTm9kZSk6IFN0YXRzIHtcbiAgICB2YXIgcGF0aCA9IHRoaXMuZnMucmVhbFBhdGgobm9kZSk7XG4gICAgdmFyIHN0YXQ6IG5vZGVfZnNfc3RhdHMuU3RhdHM7XG4gICAgdHJ5IHtcbiAgICAgIHN0YXQgPSBmcy5sc3RhdFN5bmMocGF0aCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKCFlLmNvZGUpIHRocm93IGU7XG4gICAgICB0aHJvdyBuZXcgdGhpcy5GUy5FcnJub0Vycm9yKHRoaXMuRVJSTk9fQ09ERVNbZS5jb2RlXSk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBkZXY6IHN0YXQuZGV2LFxuICAgICAgaW5vOiBzdGF0LmlubyxcbiAgICAgIG1vZGU6IHN0YXQubW9kZSxcbiAgICAgIG5saW5rOiBzdGF0Lm5saW5rLFxuICAgICAgdWlkOiBzdGF0LnVpZCxcbiAgICAgIGdpZDogc3RhdC5naWQsXG4gICAgICByZGV2OiBzdGF0LnJkZXYsXG4gICAgICBzaXplOiBzdGF0LnNpemUsXG4gICAgICBhdGltZTogc3RhdC5hdGltZSxcbiAgICAgIG10aW1lOiBzdGF0Lm10aW1lLFxuICAgICAgY3RpbWU6IHN0YXQuY3RpbWUsXG4gICAgICBibGtzaXplOiBzdGF0LmJsa3NpemUsXG4gICAgICBibG9ja3M6IHN0YXQuYmxvY2tzXG4gICAgfTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRhdHRyKG5vZGU6IEVtc2NyaXB0ZW5GU05vZGUsIGF0dHI6IFN0YXRzKTogdm9pZCB7XG4gICAgdmFyIHBhdGggPSB0aGlzLmZzLnJlYWxQYXRoKG5vZGUpO1xuICAgIHRyeSB7XG4gICAgICBpZiAoYXR0ci5tb2RlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZnMuY2htb2RTeW5jKHBhdGgsIGF0dHIubW9kZSk7XG4gICAgICAgIC8vIHVwZGF0ZSB0aGUgY29tbW9uIG5vZGUgc3RydWN0dXJlIG1vZGUgYXMgd2VsbFxuICAgICAgICBub2RlLm1vZGUgPSBhdHRyLm1vZGU7XG4gICAgICB9XG4gICAgICBpZiAoYXR0ci50aW1lc3RhbXAgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKGF0dHIudGltZXN0YW1wKTtcbiAgICAgICAgZnMudXRpbWVzU3luYyhwYXRoLCBkYXRlLCBkYXRlKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoIWUuY29kZSkgdGhyb3cgZTtcbiAgICAgIC8vIElnbm9yZSBub3Qgc3VwcG9ydGVkIGVycm9ycy4gRW1zY3JpcHRlbiBkb2VzIHV0aW1lc1N5bmMgd2hlbiBpdFxuICAgICAgLy8gd3JpdGVzIGZpbGVzLCBidXQgbmV2ZXIgcmVhbGx5IHJlcXVpcmVzIHRoZSB2YWx1ZSB0byBiZSBzZXQuXG4gICAgICBpZiAoZS5jb2RlICE9PSBcIkVOT1RTVVBcIikge1xuICAgICAgICB0aHJvdyBuZXcgdGhpcy5GUy5FcnJub0Vycm9yKHRoaXMuRVJSTk9fQ09ERVNbZS5jb2RlXSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChhdHRyLnNpemUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZnMudHJ1bmNhdGVTeW5jKHBhdGgsIGF0dHIuc2l6ZSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmICghZS5jb2RlKSB0aHJvdyBlO1xuICAgICAgICB0aHJvdyBuZXcgdGhpcy5GUy5FcnJub0Vycm9yKHRoaXMuRVJSTk9fQ09ERVNbZS5jb2RlXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGxvb2t1cChwYXJlbnQ6IEVtc2NyaXB0ZW5GU05vZGUsIG5hbWU6IHN0cmluZyk6IEVtc2NyaXB0ZW5GU05vZGUge1xuICAgIHZhciBwYXRoID0gdGhpcy5QQVRILmpvaW4yKHRoaXMuZnMucmVhbFBhdGgocGFyZW50KSwgbmFtZSk7XG4gICAgdmFyIG1vZGUgPSB0aGlzLmZzLmdldE1vZGUocGF0aCk7XG4gICAgcmV0dXJuIHRoaXMuZnMuY3JlYXRlTm9kZShwYXJlbnQsIG5hbWUsIG1vZGUpO1xuICB9XG5cbiAgcHVibGljIG1rbm9kKHBhcmVudDogRW1zY3JpcHRlbkZTTm9kZSwgbmFtZTogc3RyaW5nLCBtb2RlOiBudW1iZXIsIGRldjogYW55KTogRW1zY3JpcHRlbkZTTm9kZSB7XG4gICAgdmFyIG5vZGUgPSB0aGlzLmZzLmNyZWF0ZU5vZGUocGFyZW50LCBuYW1lLCBtb2RlLCBkZXYpO1xuICAgIC8vIGNyZWF0ZSB0aGUgYmFja2luZyBub2RlIGZvciB0aGlzIGluIHRoZSBmcyByb290IGFzIHdlbGxcbiAgICB2YXIgcGF0aCA9IHRoaXMuZnMucmVhbFBhdGgobm9kZSk7XG4gICAgdHJ5IHtcbiAgICAgIGlmICh0aGlzLkZTLmlzRGlyKG5vZGUubW9kZSkpIHtcbiAgICAgICAgZnMubWtkaXJTeW5jKHBhdGgsIG5vZGUubW9kZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmcy53cml0ZUZpbGVTeW5jKHBhdGgsICcnLCB7IG1vZGU6IG5vZGUubW9kZSB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoIWUuY29kZSkgdGhyb3cgZTtcbiAgICAgIHRocm93IG5ldyB0aGlzLkZTLkVycm5vRXJyb3IodGhpcy5FUlJOT19DT0RFU1tlLmNvZGVdKTtcbiAgICB9XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICBwdWJsaWMgcmVuYW1lKG9sZE5vZGU6IEVtc2NyaXB0ZW5GU05vZGUsIG5ld0RpcjogRW1zY3JpcHRlbkZTTm9kZSwgbmV3TmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgdmFyIG9sZFBhdGggPSB0aGlzLmZzLnJlYWxQYXRoKG9sZE5vZGUpO1xuICAgIHZhciBuZXdQYXRoID0gdGhpcy5QQVRILmpvaW4yKHRoaXMuZnMucmVhbFBhdGgobmV3RGlyKSwgbmV3TmFtZSk7XG4gICAgdHJ5IHtcbiAgICAgIGZzLnJlbmFtZVN5bmMob2xkUGF0aCwgbmV3UGF0aCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKCFlLmNvZGUpIHRocm93IGU7XG4gICAgICB0aHJvdyBuZXcgdGhpcy5GUy5FcnJub0Vycm9yKHRoaXMuRVJSTk9fQ09ERVNbZS5jb2RlXSk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHVubGluayhwYXJlbnQ6IEVtc2NyaXB0ZW5GU05vZGUsIG5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHZhciBwYXRoID0gdGhpcy5QQVRILmpvaW4yKHRoaXMuZnMucmVhbFBhdGgocGFyZW50KSwgbmFtZSk7XG4gICAgdHJ5IHtcbiAgICAgIGZzLnVubGlua1N5bmMocGF0aCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKCFlLmNvZGUpIHRocm93IGU7XG4gICAgICB0aHJvdyBuZXcgdGhpcy5GUy5FcnJub0Vycm9yKHRoaXMuRVJSTk9fQ09ERVNbZS5jb2RlXSk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHJtZGlyKHBhcmVudDogRW1zY3JpcHRlbkZTTm9kZSwgbmFtZTogc3RyaW5nKSB7XG4gICAgdmFyIHBhdGggPSB0aGlzLlBBVEguam9pbjIodGhpcy5mcy5yZWFsUGF0aChwYXJlbnQpLCBuYW1lKTtcbiAgICB0cnkge1xuICAgICAgZnMucm1kaXJTeW5jKHBhdGgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmICghZS5jb2RlKSB0aHJvdyBlO1xuICAgICAgdGhyb3cgbmV3IHRoaXMuRlMuRXJybm9FcnJvcih0aGlzLkVSUk5PX0NPREVTW2UuY29kZV0pO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyByZWFkZGlyKG5vZGU6IEVtc2NyaXB0ZW5GU05vZGUpOiBzdHJpbmdbXSB7XG4gICAgdmFyIHBhdGggPSB0aGlzLmZzLnJlYWxQYXRoKG5vZGUpO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gZnMucmVhZGRpclN5bmMocGF0aCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKCFlLmNvZGUpIHRocm93IGU7XG4gICAgICB0aHJvdyBuZXcgdGhpcy5GUy5FcnJub0Vycm9yKHRoaXMuRVJSTk9fQ09ERVNbZS5jb2RlXSk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHN5bWxpbmsocGFyZW50OiBFbXNjcmlwdGVuRlNOb2RlLCBuZXdOYW1lOiBzdHJpbmcsIG9sZFBhdGg6IHN0cmluZyk6IHZvaWQge1xuICAgIHZhciBuZXdQYXRoID0gdGhpcy5QQVRILmpvaW4yKHRoaXMuZnMucmVhbFBhdGgocGFyZW50KSwgbmV3TmFtZSk7XG4gICAgdHJ5IHtcbiAgICAgIGZzLnN5bWxpbmtTeW5jKG9sZFBhdGgsIG5ld1BhdGgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmICghZS5jb2RlKSB0aHJvdyBlO1xuICAgICAgdGhyb3cgbmV3IHRoaXMuRlMuRXJybm9FcnJvcih0aGlzLkVSUk5PX0NPREVTW2UuY29kZV0pO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyByZWFkbGluayhub2RlOiBFbXNjcmlwdGVuRlNOb2RlKTogc3RyaW5nIHtcbiAgICB2YXIgcGF0aCA9IHRoaXMuZnMucmVhbFBhdGgobm9kZSk7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBmcy5yZWFkbGlua1N5bmMocGF0aCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKCFlLmNvZGUpIHRocm93IGU7XG4gICAgICB0aHJvdyBuZXcgdGhpcy5GUy5FcnJub0Vycm9yKHRoaXMuRVJSTk9fQ09ERVNbZS5jb2RlXSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJGU0Vtc2NyaXB0ZW5GUyBpbXBsZW1lbnRzIEVtc2NyaXB0ZW5GUyB7XG4gIHByaXZhdGUgRlM6IGFueTtcbiAgcHJpdmF0ZSBQQVRIOiBhbnk7XG4gIHByaXZhdGUgRVJSTk9fQ09ERVM6IGFueTtcbiAgY29uc3RydWN0b3IoX0ZTID0gKDxhbnk+IHNlbGYpWydGUyddLCBfUEFUSCA9ICg8YW55PiBzZWxmKVsnUEFUSCddLCBfRVJSTk9fQ09ERVMgPSAoPGFueT4gc2VsZilbJ0VSUk5PX0NPREVTJ10pIHtcbiAgICBpZiAodHlwZW9mIEJyb3dzZXJGUyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkJyb3dzZXJGUyBpcyBub3QgbG9hZGVkLiBQbGVhc2UgbG9hZCBpdCBiZWZvcmUgdGhpcyBsaWJyYXJ5LlwiKTtcbiAgICB9XG4gICAgdGhpcy5GUyA9IF9GUztcbiAgICB0aGlzLlBBVEggPSBfUEFUSDtcbiAgICB0aGlzLkVSUk5PX0NPREVTID0gX0VSUk5PX0NPREVTO1xuICAgIHRoaXMubm9kZV9vcHMgPSBuZXcgQkZTRW1zY3JpcHRlbk5vZGVPcHModGhpcyk7XG4gICAgdGhpcy5zdHJlYW1fb3BzID0gbmV3IEJGU0Vtc2NyaXB0ZW5TdHJlYW1PcHModGhpcyk7XG4gIH1cblxuICBwdWJsaWMgbW91bnQobW91bnQ6IHtvcHRzOiB7cm9vdDogc3RyaW5nfX0pOiBFbXNjcmlwdGVuRlNOb2RlIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVOb2RlKG51bGwsICcvJywgdGhpcy5nZXRNb2RlKG1vdW50Lm9wdHMucm9vdCksIDApO1xuICB9XG5cbiAgcHVibGljIGNyZWF0ZU5vZGUocGFyZW50OiBFbXNjcmlwdGVuRlNOb2RlLCBuYW1lOiBzdHJpbmcsIG1vZGU6IG51bWJlciwgZGV2PzogYW55KTogRW1zY3JpcHRlbkZTTm9kZSB7XG4gICAgdmFyIEZTID0gdGhpcy5GUztcbiAgICBpZiAoIUZTLmlzRGlyKG1vZGUpICYmICFGUy5pc0ZpbGUobW9kZSkgJiYgIUZTLmlzTGluayhtb2RlKSkge1xuICAgICAgdGhyb3cgbmV3IEZTLkVycm5vRXJyb3IodGhpcy5FUlJOT19DT0RFUy5FSU5WQUwpO1xuICAgIH1cbiAgICB2YXIgbm9kZSA9IEZTLmNyZWF0ZU5vZGUocGFyZW50LCBuYW1lLCBtb2RlKTtcbiAgICBub2RlLm5vZGVfb3BzID0gdGhpcy5ub2RlX29wcztcbiAgICBub2RlLnN0cmVhbV9vcHMgPSB0aGlzLnN0cmVhbV9vcHM7XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICBwdWJsaWMgZ2V0TW9kZShwYXRoOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIHZhciBzdGF0OiBub2RlX2ZzX3N0YXRzLlN0YXRzO1xuICAgIHRyeSB7XG4gICAgICBzdGF0ID0gZnMubHN0YXRTeW5jKHBhdGgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmICghZS5jb2RlKSB0aHJvdyBlO1xuICAgICAgdGhyb3cgbmV3IHRoaXMuRlMuRXJybm9FcnJvcih0aGlzLkVSUk5PX0NPREVTW2UuY29kZV0pO1xuICAgIH1cbiAgICByZXR1cm4gc3RhdC5tb2RlO1xuICB9XG5cbiAgcHVibGljIHJlYWxQYXRoKG5vZGU6IEVtc2NyaXB0ZW5GU05vZGUpOiBzdHJpbmcge1xuICAgIHZhciBwYXJ0czogc3RyaW5nW10gPSBbXTtcbiAgICB3aGlsZSAobm9kZS5wYXJlbnQgIT09IG5vZGUpIHtcbiAgICAgIHBhcnRzLnB1c2gobm9kZS5uYW1lKTtcbiAgICAgIG5vZGUgPSBub2RlLnBhcmVudDtcbiAgICB9XG4gICAgcGFydHMucHVzaChub2RlLm1vdW50Lm9wdHMucm9vdCk7XG4gICAgcGFydHMucmV2ZXJzZSgpO1xuICAgIHJldHVybiB0aGlzLlBBVEguam9pbi5hcHBseShudWxsLCBwYXJ0cyk7XG4gIH1cbiAgLy8gVGhpcyBtYXBzIHRoZSBpbnRlZ2VyIHBlcm1pc3Npb24gbW9kZXMgZnJvbSBodHRwOi8vbGludXguZGllLm5ldC9tYW4vMy9vcGVuXG4gIC8vIHRvIG5vZGUuanMtc3BlY2lmaWMgZmlsZSBvcGVuIHBlcm1pc3Npb24gc3RyaW5ncyBhdCBodHRwOi8vbm9kZWpzLm9yZy9hcGkvZnMuaHRtbCNmc19mc19vcGVuX3BhdGhfZmxhZ3NfbW9kZV9jYWxsYmFja1xuICBwdWJsaWMgZmxhZ3NUb1Blcm1pc3Npb25TdHJpbmdNYXAgPSB7XG4gICAgMC8qT19SRE9OTFkqLzogJ3InLFxuICAgIDEvKk9fV1JPTkxZKi86ICdyKycsXG4gICAgMi8qT19SRFdSKi86ICdyKycsXG4gICAgNjQvKk9fQ1JFQVQqLzogJ3InLFxuICAgIDY1LypPX1dST05MWXxPX0NSRUFUKi86ICdyKycsXG4gICAgNjYvKk9fUkRXUnxPX0NSRUFUKi86ICdyKycsXG4gICAgMTI5LypPX1dST05MWXxPX0VYQ0wqLzogJ3J4KycsXG4gICAgMTkzLypPX1dST05MWXxPX0NSRUFUfE9fRVhDTCovOiAncngrJyxcbiAgICA1MTQvKk9fUkRXUnxPX1RSVU5DKi86ICd3KycsXG4gICAgNTc3LypPX1dST05MWXxPX0NSRUFUfE9fVFJVTkMqLzogJ3cnLFxuICAgIDU3OC8qT19DUkVBVHxPX1JEV1J8T19UUlVOQyovOiAndysnLFxuICAgIDcwNS8qT19XUk9OTFl8T19DUkVBVHxPX0VYQ0x8T19UUlVOQyovOiAnd3gnLFxuICAgIDcwNi8qT19SRFdSfE9fQ1JFQVR8T19FWENMfE9fVFJVTkMqLzogJ3d4KycsXG4gICAgMTAyNC8qT19BUFBFTkQqLzogJ2EnLFxuICAgIDEwMjUvKk9fV1JPTkxZfE9fQVBQRU5EKi86ICdhJyxcbiAgICAxMDI2LypPX1JEV1J8T19BUFBFTkQqLzogJ2ErJyxcbiAgICAxMDg5LypPX1dST05MWXxPX0NSRUFUfE9fQVBQRU5EKi86ICdhJyxcbiAgICAxMDkwLypPX1JEV1J8T19DUkVBVHxPX0FQUEVORCovOiAnYSsnLFxuICAgIDExNTMvKk9fV1JPTkxZfE9fRVhDTHxPX0FQUEVORCovOiAnYXgnLFxuICAgIDExNTQvKk9fUkRXUnxPX0VYQ0x8T19BUFBFTkQqLzogJ2F4KycsXG4gICAgMTIxNy8qT19XUk9OTFl8T19DUkVBVHxPX0VYQ0x8T19BUFBFTkQqLzogJ2F4JyxcbiAgICAxMjE4LypPX1JEV1J8T19DUkVBVHxPX0VYQ0x8T19BUFBFTkQqLzogJ2F4KycsXG4gICAgNDA5Ni8qT19SRE9OTFl8T19EU1lOQyovOiAncnMnLFxuICAgIDQwOTgvKk9fUkRXUnxPX0RTWU5DKi86ICdycysnXG4gIH1cblxuICBwdWJsaWMgZmxhZ3NUb1Blcm1pc3Npb25TdHJpbmcoZmxhZ3M6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgdmFyIHBhcnNlZEZsYWdzID0gKHR5cGVvZiBmbGFncyA9PT0gXCJzdHJpbmdcIikgPyBwYXJzZUludChmbGFncywgMTApIDogPG51bWJlcj48YW55PiBmbGFncztcbiAgICBwYXJzZWRGbGFncyAmPSAweDFGRkY7XG4gICAgaWYgKHBhcnNlZEZsYWdzIGluIHRoaXMuZmxhZ3NUb1Blcm1pc3Npb25TdHJpbmdNYXApIHtcbiAgICAgIHJldHVybiAoPGFueT4gdGhpcy5mbGFnc1RvUGVybWlzc2lvblN0cmluZ01hcClbcGFyc2VkRmxhZ3NdO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmxhZ3M7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGdldEZTKCkge1xuICAgIHJldHVybiB0aGlzLkZTO1xuICB9XG5cbiAgcHVibGljIGdldFBBVEgoKSB7XG4gICAgcmV0dXJuIHRoaXMuUEFUSDtcbiAgfVxuXG4gIHB1YmxpYyBnZXRFUlJOT19DT0RFUygpIHtcbiAgICByZXR1cm4gdGhpcy5FUlJOT19DT0RFUztcbiAgfVxuXG4gIHB1YmxpYyBub2RlX29wczogRW1zY3JpcHRlbk5vZGVPcHM7XG4gIHB1YmxpYyBzdHJlYW1fb3BzOiBFbXNjcmlwdGVuU3RyZWFtT3BzO1xufVxuIl19